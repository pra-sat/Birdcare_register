<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>system admin</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
</head>
<body>
  <div class="container">
    <h2>ЁЯЫа р╣Бр╕Ьр╕Зр╕Др╕зр╕Ър╕Др╕╕р╕бр╕Ьр╕╣р╣Йр╕Фр╕╣р╣Бр╕ер╕гр╕░р╕Ър╕Ъ</h2>
    <p class="admin-name">ЁЯСд р╕Др╕╕р╕У: <span id="adminName">р╕гр╕нр╣Вр╕лр╕ер╕Фр╕Кр╕╖р╣Ир╕н...</span></p>

    <div class="admin-buttons">
      <a class="btn" href="scan.html">ЁЯФН р╕кр╣Бр╕Бр╕Щ QR р╣Ар╕Юр╕╖р╣Ир╕нр╣Ар╕Юр╕┤р╣Ир╕бр╕Ър╕гр╕┤р╕Бр╕▓р╕г</a>
      <a class="btn" href="stats.html">ЁЯУК р╕гр╕▓р╕вр╕Зр╕▓р╕Щ/р╕кр╕Цр╕┤р╕Хр╕┤</a>
      <a class="btn hidden" id="settingsBtn" href="settings.html">тЪЩя╕П р╕Ир╕▒р╕Фр╕Бр╕▓р╕гр╣Вр╕Ыр╕гр╣Вр╕бр╕Кр╕▒р╕Щ/р╕Вр╕нр╕Зр╕гр╕▓р╕Зр╕зр╕▒р╕е</a>
      <a class="btn" href="feedback.html">ЁЯТм р╕Вр╣Йр╕нр╣Ар╕кр╕Щр╕нр╣Бр╕Щр╕░р╕Ир╕▓р╕Бр╕ер╕╣р╕Бр╕Др╣Йр╕▓</a>
    </div>
  </div>

  <script>
    const SHEET_API = 'https://script.google.com/macros/s/YOUR_DEPLOYED_ID/exec';
    const liffId = 'YOUR_LIFF_ID';

    document.addEventListener('DOMContentLoaded', async () => {
      try {
        await liff.init({ liffId });
        if (!liff.isLoggedIn()) return liff.login();

        const profile = await liff.getProfile();
        const userId = profile.userId;

        const res = await fetch(`${SHEET_API}?action=check_admin&userId=${userId}`);
        const result = await res.json();

        document.getElementById('adminName').textContent = result.name || 'р╣Др╕бр╣Ир╕Чр╕гр╕▓р╕Ър╕Кр╕╖р╣Ир╕н';

        const level = parseInt(result.level || "0");
        if (level >= 5) {
          document.getElementById('settingsBtn').classList.remove('hidden');
        }

      } catch (err) {
        alert("р╣Ар╕Бр╕┤р╕Фр╕Вр╣Йр╕нр╕Ьр╕┤р╕Фр╕Юр╕ер╕▓р╕Фр╣Гр╕Щр╕Бр╕▓р╕гр╣Вр╕лр╕ер╕Фр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й");
        console.error(err);
      }
    });
  </script>
</body>
</html>
